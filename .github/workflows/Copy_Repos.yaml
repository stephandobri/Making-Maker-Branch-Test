# This GitHUb Action copies repos based on a text file that indicates which repos to copy

# To run, this file requires a separate file, Included_Device_Repos.txt to be in the same folder as this file.

name: Copy_Device_Repositories

# Choose how to trigger the workflow
on:
    # Trigger the workflow manually
    workflow_dispatch:
    # Trigger the workflow on a schedule. In this case, once at midnight, and once at noon.
    #schedule:
    #    - cron: '0 0,12 * * *'

jobs:
    file_contents:
        runs-on: ubuntu-latest
        steps:
             # Checkout the kit repo
        - name: Checkout the kit repo
          uses: actions/checkout@v6

        - name: Install Python dependencies
          run: python -m pip install --upgrade pip pandas
        
            # Read the file that includes all the repos
        - name: Read repo names
          id: read_file
          # Use python to read the CSV file and create a dynamic matrix with all the devices to add to the kit repo
          shell: python
          run: |
              import pandas
              import json
              fields = 'RepoName'
              included_devices = pandas.read_csv('.github/workflows/Included_Devices.csv', skipinitialspace=True, usecols=fields)
              print(included_devices)
              devices = []
              for x in included_devices.RepoName:
                  devices += [json.dumps(included_devices.RepoName(x))]
              print(devices)

   # create_matrix:
      #  runs-on: ubuntu-latest
      #  needs: file_contents
        # Make a matrix of repo names to run the next section of code with a matrix strategy
      #  strategy:
      #    matrix:
       #     devices: [Interact-Switch, MMC60_Assisitve_Switch, Light-Touch-Switch, Raindrop-Switch]

       # steps:

       # - name: Read through the files
        
                
            
